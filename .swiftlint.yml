# =============================================================================
# BibleStudy Design System Linting Configuration
# =============================================================================
# This configuration enforces design token usage and catches hardcoded values.
# See /BibleStudy/UI/Theme/README.md for token reference.
# =============================================================================

# === RULE SELECTION ===
# Run ONLY our custom design system rules (avoid unrelated noise)
only_rules:
  - custom_rules  # Required literal to enable custom_rules with only_rules

# === BEHAVIOR ===
lenient: true  # Treat errors as warnings (never block builds)
reporter: xcode  # Xcode-friendly output

# === PATHS ===
included:
  - BibleStudy

excluded:
  - build
  - BibleStudy/UI/Theme  # Token definitions allowed here
  - BibleStudy/Resources
  - "*.generated.swift"
  - Scripts/LintTests  # Test fixtures excluded

# === BASELINE ===
# Generated with 473 violations on 2026-01-10 (includes colorScheme ban)
# Remove violations from baseline as they are fixed
# Existing violations are hidden, new violations are caught
baseline: swiftlint_baseline.json

# =============================================================================
# CUSTOM RULES - Design System Enforcement
# =============================================================================

custom_rules:

  # ---------------------------------------------------------------------------
  # COLORS
  # ---------------------------------------------------------------------------

  hardcoded_color_rgb:
    name: "Hardcoded RGB Color"
    regex: 'Color\s*\(\s*(red|\.sRGB.*red)\s*:'
    message: "Use semantic colors from Colors.swift (Color.primaryText, Color.accentGold, etc.)"
    severity: warning

  hardcoded_color_white:
    name: "Hardcoded White/Gray Color"
    regex: 'Color\s*\(\s*white\s*:'
    message: "Use semantic colors from Colors.swift"
    severity: warning

  hardcoded_uicolor_rgb:
    name: "Hardcoded UIColor"
    regex: 'UIColor\s*\(\s*(red|hue)\s*:'
    message: "Use semantic colors converted to UIColor"
    severity: warning

  # ---------------------------------------------------------------------------
  # TYPOGRAPHY
  # ---------------------------------------------------------------------------

  hardcoded_font_system:
    name: "Hardcoded System Font Size"
    # Match .font(.system(size: X)) - use Typography tokens instead
    regex: '\.font\s*\(\s*\.system\s*\(\s*size\s*:\s*\d'
    message: "Use Typography.Scripture.*, Typography.Command.*, or Typography.Icon.*"
    severity: warning

  hardcoded_font_custom:
    name: "Hardcoded Custom Font Size"
    regex: '\.font\s*\(\s*\.custom\s*\([^)]+,\s*size\s*:'
    message: "Use Typography constants"
    severity: warning

  hardcoded_font_creation:
    name: "Hardcoded Font Creation"
    # Match Font.system(size: X) where X is a digit (hardcoded), not a variable
    regex: 'Font\s*\.\s*system\s*\(\s*size\s*:\s*\d'
    message: "Use Typography.UI.*, Typography.Display.*, or Typography.Scripture.*"
    severity: warning

  hardcoded_swiftui_text_style:
    name: "SwiftUI Text Style"
    regex: '\.font\s*\(\s*\.(largeTitle|title|title2|title3|headline|subheadline|body|callout|footnote|caption|caption2)\s*\)'
    message: "Use Typography.Scripture.*, Typography.Command.*, or Typography.Editorial.* instead of SwiftUI text styles"
    severity: warning

  # ---------------------------------------------------------------------------
  # SPACING
  # ---------------------------------------------------------------------------

  hardcoded_padding_single:
    name: "Hardcoded Padding Value"
    regex: '\.padding\s*\(\s*\d+\.?\d*\s*\)'
    message: "Use Theme.Spacing.* (xs:6, sm:10, md:16, lg:24, xl:32, xxl:48)"
    severity: warning

  hardcoded_padding_edge:
    name: "Hardcoded Edge Padding"
    regex: '\.padding\s*\(\s*\.(horizontal|vertical|top|bottom|leading|trailing)\s*,\s*\d+'
    message: "Use Theme.Spacing.*"
    severity: warning

  hardcoded_padding_edge_insets:
    name: "Hardcoded EdgeInsets"
    regex: '\.padding\s*\(\s*EdgeInsets\s*\([^)]*\d+'
    message: "Use Theme.Spacing.*"
    severity: warning

  hardcoded_stack_spacing:
    name: "Hardcoded Stack Spacing"
    regex: '(VStack|HStack|LazyVStack|LazyHStack)\s*\([^)]*spacing\s*:\s*[1-9]\d*'
    message: "Use Theme.Spacing.*"
    severity: warning

  hardcoded_grid_spacing:
    name: "Hardcoded Grid Spacing"
    regex: 'Grid\s*\([^)]*spacing\s*:\s*\d+'
    message: "Use Theme.Spacing.*"
    severity: warning

  # ---------------------------------------------------------------------------
  # CORNER RADIUS
  # ---------------------------------------------------------------------------

  hardcoded_corner_radius_modifier:
    name: "Hardcoded cornerRadius Modifier"
    regex: '\.cornerRadius\s*\(\s*\d+'
    message: "Use Theme.Radius.* (xs:2, tag:6, input:8, button:10, card:14, xl:16, sheet:20)"
    severity: warning

  hardcoded_rounded_rectangle:
    name: "Hardcoded RoundedRectangle"
    regex: 'RoundedRectangle\s*\(\s*cornerRadius\s*:\s*\d+'
    message: "Use Theme.Radius.*"
    severity: warning

  hardcoded_uirounded_rect:
    name: "UIKit Corner Masking"
    regex: 'UIRectCorner|CACornerMask'
    message: "Prefer SwiftUI RoundedRectangle with Theme.Radius.*"
    severity: warning

  # ---------------------------------------------------------------------------
  # ANIMATIONS - Motion doctrine: "Ceremonial, restrained, almost invisible"
  # ALL cubic easing, NO spring animations
  # ---------------------------------------------------------------------------

  hardcoded_animation_ease:
    name: "Hardcoded Ease Animation"
    # Only match when duration is followed by a digit (not a variable)
    regex: '\.(easeIn|easeOut|easeInOut|linear)\s*\(\s*duration\s*:\s*\d'
    message: "Use Theme.Animation.* (fade:0.22, settle:0.26, slowFade:0.42)"
    severity: warning

  hardcoded_animation_spring:
    name: "Hardcoded Spring Animation"
    regex: '\.spring\s*\(\s*(response|duration)\s*:'
    message: "Spring animations banned per motion doctrine - use Theme.Animation.settle for weight"
    severity: warning

  hardcoded_with_animation:
    name: "Hardcoded withAnimation"
    # Only match withAnimation with hardcoded duration, not variables/expressions
    regex: 'withAnimation\s*\(\s*\.(easeIn|easeOut|easeInOut)\s*\(\s*duration\s*:\s*\d'
    message: "Use Theme.Animation.* in withAnimation"
    severity: warning

  hardcoded_animation_creation:
    name: "Hardcoded Animation Creation"
    regex: 'Animation\s*\.\s*(easeIn|easeOut|easeInOut|linear|spring)\s*\('
    message: "Use Theme.Animation.*"
    severity: warning

  # ---------------------------------------------------------------------------
  # OPACITY (Phase 2)
  # ---------------------------------------------------------------------------

  hardcoded_opacity:
    name: "Hardcoded Opacity Value"
    regex: '\.opacity\(0\.[0-9]+'
    message: "Use Theme.Opacity.* (pressed:0.80, disabled:0.35, focusStroke:0.60, selectionBackground:0.15, textPrimary:0.96, textSecondary:0.75, textTertiary:0.60, divider:0.12, overlay:0.10, subtle:0.05, highlight:0.40)"
    severity: warning

  # ---------------------------------------------------------------------------
  # BORDER/STROKE
  # ---------------------------------------------------------------------------

  hardcoded_line_width:
    name: "Hardcoded Line Width"
    regex: 'lineWidth:\s*[0-9]+'
    message: "Use Theme.Stroke.* (hairline:1, control:2)"
    severity: warning

  # ---------------------------------------------------------------------------
  # ICON/SIZE TOKENS
  # ---------------------------------------------------------------------------

  hardcoded_icon_frame:
    name: "Hardcoded Icon Frame"
    regex: '\.frame\(width:\s*(24|32)\)'
    message: "Use Theme.Size.* (iconSize:24, iconSizeLarge:32)"
    severity: warning

  hardcoded_touch_target:
    name: "Hardcoded Touch Target"
    regex: 'minWidth:\s*44|minHeight:\s*44'
    message: "Use Theme.Size.minTapTarget (44) for touch targets"
    severity: warning

  # ---------------------------------------------------------------------------
  # SPACER HEIGHTS
  # ---------------------------------------------------------------------------

  hardcoded_spacer_frame:
    name: "Hardcoded Spacer Frame"
    regex: 'Spacer\(\)\.frame\(height:\s*\d+'
    message: "Use Theme.Spacing.* for spacer heights"
    severity: warning

  # ---------------------------------------------------------------------------
  # SHADOWS - Design doctrine: "Default: none, prefer strokes over shadows"
  # No shadow tokens - use inline .shadow() when legitimately needed
  # ---------------------------------------------------------------------------

  # ---------------------------------------------------------------------------
  # DEPRECATED RULES (tokens don't exist - use inline values)
  # ---------------------------------------------------------------------------
  # Blur: No Theme.Blur tokens - use inline .blur(radius:) when needed
  # Scale: No Theme.Scale tokens - use inline .scaleEffect() when needed
  # Divider frame: Too aggressive - conflicts with legitimate small frames
  # Indicator size: No Theme.ComponentSize tokens

  # ---------------------------------------------------------------------------
  # ROMAN/STOIC DESIGN SYSTEM MIGRATION (Phase 9)
  # ---------------------------------------------------------------------------
  # These rules guide migration from Scholar/Manuscript theme to Roman/Stoic
  # Phase 1: warnings (non-blocking)
  # Phase 2: errors (after migration complete)

  deprecated_scholar_indigo:
    name: "Deprecated Scholar Indigo - Migrate to Imperial Purple"
    regex: '\.scholarIndigo(?!Light|Dark|Accessible|Pressed)'
    message: "Migrate to .imperialPurple or Color.Stoic.accent for Roman/Stoic design"
    severity: warning

  deprecated_divine_gold:
    name: "Deprecated Divine Gold - Migrate to Laurel Gold"
    regex: '\.divineGold'
    message: "Migrate to .laurelGold or Color.Stoic.decorativeAccent"
    severity: warning

  deprecated_fresh_vellum:
    name: "Deprecated Fresh Vellum - Use Surface"
    regex: '\.freshVellum'
    message: "Use Color.Surface.backgroundPrimary or .marbleWhite"
    severity: warning

  deprecated_candlelit_stone:
    name: "Deprecated Candlelit Stone - Use Surface"
    regex: '\.candlelitStone'
    message: "Use Color.Surface.background(for:) or .forumNight for dark mode"
    severity: warning

  deprecated_aged_parchment:
    name: "Deprecated Aged Parchment - Use Surface"
    regex: '\.agedParchment'
    message: "Use Color.Surface.sepiaBackground or .antiqueStone"
    severity: warning

  deprecated_monastery_stone:
    name: "Deprecated Monastery Stone - Use Surface"
    regex: '\.monasteryStone'
    message: "Use Color.Surface.sepiaElevated"
    severity: warning

  # ---------------------------------------------------------------------------
  # 3-LAYER ARCHITECTURE ENFORCEMENT (Phase 9b)
  # ---------------------------------------------------------------------------
  # The Roman/Stoic design system uses a 3-layer color architecture:
  #   Layer 1: Pigments (raw colors) - ONLY in BibleStudy/UI/Theme/
  #   Layer 2: Surfaces (Color.Surface.*) - Theme-aware backgrounds/text
  #   Layer 3: Semantics (Color.Stoic.*) - Role-based colors
  #
  # Components should use Layer 2 or 3, not Layer 1 pigments directly.
  # NOTE: BibleStudy/UI/Theme/ is excluded in global config (definitions allowed there)
  #
  # For intentional decorative pigment use, add comment: // DECORATIVE: reason

  direct_pigment_status:
    name: "Direct Status Pigment - Use Semantic Layer"
    regex: '\.(cinnabarRed|malachiteGreen|orpimentYellow)\b'
    message: "Use Color.Stoic.error/success/warning instead of raw status pigments"
    severity: warning

  direct_pigment_accent:
    name: "Direct Accent Pigment - Consider Semantic Layer"
    regex: '\.(tyrianPurple|terracottaRed|basilicaBlue)\b'
    message: "Consider using Color.Stoic.* semantic colors unless intentionally decorative"
    severity: warning

  direct_pigment_neutral:
    name: "Direct Neutral Pigment - Use Surface Layer"
    regex: '\.(stoicCharcoal|stoicSlate|moonlitMarble|forumNight|marbleWhite)\b(?!\.opacity)'
    message: "Use Color.Surface.textPrimary/textSecondary/background(for:) for theme-aware neutrals"
    severity: warning

  surface_hardcoded_dark_check:
    name: "Hardcoded Dark Mode Check - Use Surface Layer"
    regex: 'colorScheme\s*==\s*\.dark\s*\?\s*Color\.'
    message: "Consider Color.Surface.*(for:) or Color.Surface.*(colorScheme:) for theme-aware colors"
    severity: warning

  banned_colorscheme_environment:
    name: "Banned colorScheme Environment"
    regex: '@Environment\(\\\.colorScheme\)'
    message: "Do not use colorScheme - define light/dark variants in Asset Catalog instead"
    severity: error

  banned_colorscheme_usage:
    name: "Banned colorScheme Usage"
    regex: '\bcolorScheme\s*==\s*\.(dark|light)'
    message: "Do not check colorScheme - use Asset Catalog colors with automatic light/dark mode"
    severity: error

  # ---------------------------------------------------------------------------
  # TIME-AWARE DEPRECATION (Cleanup Phase)
  # ---------------------------------------------------------------------------
  # These colors are deprecated as part of removing time-awareness from Home
  # They will be removed after all usages are migrated

  deprecated_dawn_palette:
    name: "Deprecated Dawn Palette - Time-awareness removed"
    regex: '\.(dawnLavender|dawnPeriwinkle|dawnRosePink|dawnAccent|dawnFrost|dawnSlate)\b'
    message: "Dawn palette deprecated - use Roman/Stoic colors with Surface layer"
    severity: warning

  deprecated_meridian_palette:
    name: "Deprecated Meridian Palette - Time-awareness removed"
    regex: '\.(meridianParchment|meridianGilded|meridianSepia|meridianLinen|meridianUmber)\b'
    message: "Meridian palette deprecated - use Roman/Stoic colors with Surface layer"
    severity: warning

  deprecated_afternoon_palette:
    name: "Deprecated Afternoon Palette - Time-awareness removed"
    regex: '\.(afternoonIvory|afternoonHoney|afternoonAmber|afternoonEspresso|afternoonMocha)\b'
    message: "Afternoon palette deprecated - use Roman/Stoic colors with Surface layer"
    severity: warning

  deprecated_vespers_palette:
    name: "Deprecated Vespers Palette - Time-awareness removed"
    regex: '\.(vespersIndigo|vespersSky|vespersAmber|vespersText)\b'
    message: "Vespers palette deprecated - use Roman/Stoic colors with Surface layer"
    severity: warning

  deprecated_compline_palette:
    name: "Deprecated Compline Palette - Time-awareness removed"
    regex: '\.(nightVoid|starlight|moonMist|candleAmber|roseIncense)\b'
    message: "Compline palette deprecated - use Roman/Stoic colors with Surface layer"
    severity: warning

  # NOTE: imperialPurple and laurelGold are NOT linted here
  # They are acceptable as Layer 1 decorative accents when used intentionally
  # The Swift @available deprecations on scholarIndigo/divineGold guide migration
